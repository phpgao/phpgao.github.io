<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>è®°ä¸€æ¬¡frpçš„è¢«é˜»æ–­çš„é—®é¢˜ | è€é«˜çš„æŠ€æœ¯åšå®¢</title><meta name=keywords content="tcp,frp,kcp"><meta name=description content="
ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„ç¨‹åºå‘˜ï¼Œåº”è¯¥æŠ±ç€åœ¨å“ªé‡Œéƒ½è¦åŠ ç­çš„ç†æƒ³ã€‚

ä¸ºäº†åœ¨å®¶è°ƒè¯•æ–¹ä¾¿ï¼Œè€é«˜ä½¿ç”¨frpå°†è‡ªå·±æ”¾åœ¨å…¬å¸çš„å¼€å‘æœºå™¨çš„sshç«¯å£å¼€æ”¾å‡ºæ¥äº†ï¼Œä½†æ˜¯é…ç½®frpå®¢æˆ·ç«¯çš„è¿‡ç¨‹ä¸­æ€»æ˜¯å‡ºç°ä¸‹é¢çš„ä¸€å¥è¯ï¼š
2019/08/30 23:42:47 [W] [service.go:82] login to server failed: EOF
EOF
å¼€å§‹æ€€ç–‘æ˜¯frpçš„ç‰ˆæœ¬é—®é¢˜ï¼Œäºæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ¢ä¸Šäº†æœ€æ–°çš„ç‰ˆæœ¬ï¼Œç»“æœè¿˜æ˜¯æ— æ³•è§£å†³é—®é¢˜ï¼Œç»§ç»­å°è¯•æ›´æ¢ç«¯å£ï¼Œé—®é¢˜ä¾æ—§ã€‚
ç½‘ä¸Šæœç´¢ä¸€åœˆï¼Œå‘ç°é‡åˆ°login to server failed: EOFé—®é¢˜çš„äººè¿˜çœŸä¸å°‘ï¼Œä¸‹é¢çœ‹çœ‹è€é«˜æ˜¯å¦‚ä½•è§£å†³çš„å§ï¼"><meta name=author content="Me"><link rel=canonical href=https://phpgao.github.io/frp_tcp_reset.html><link crossorigin=anonymous href=/assets/css/stylesheet.min.1a6ee89730e13a801d0f34e0cb5b98e96cf8c65b80500638bd599fc224ed8442.css integrity="sha256-Gm7olzDhOoAdDzTgy1uY6Wz4xluAUAY4vVmfwiTthEI=" rel="preload stylesheet" as=style><link rel=preload href="https://cdn.v2ex.com/gravatar/2b66f45a3e2f41db6522381006bfaea1?s=192" as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://phpgao.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://phpgao.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://phpgao.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://phpgao.github.io/apple-touch-icon.png><link rel=mask-icon href=https://phpgao.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-39288145-2','auto'),ga('send','pageview'))</script><meta property="og:title" content="è®°ä¸€æ¬¡frpçš„è¢«é˜»æ–­çš„é—®é¢˜"><meta property="og:description" content="
ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„ç¨‹åºå‘˜ï¼Œåº”è¯¥æŠ±ç€åœ¨å“ªé‡Œéƒ½è¦åŠ ç­çš„ç†æƒ³ã€‚

ä¸ºäº†åœ¨å®¶è°ƒè¯•æ–¹ä¾¿ï¼Œè€é«˜ä½¿ç”¨frpå°†è‡ªå·±æ”¾åœ¨å…¬å¸çš„å¼€å‘æœºå™¨çš„sshç«¯å£å¼€æ”¾å‡ºæ¥äº†ï¼Œä½†æ˜¯é…ç½®frpå®¢æˆ·ç«¯çš„è¿‡ç¨‹ä¸­æ€»æ˜¯å‡ºç°ä¸‹é¢çš„ä¸€å¥è¯ï¼š
2019/08/30 23:42:47 [W] [service.go:82] login to server failed: EOF
EOF
å¼€å§‹æ€€ç–‘æ˜¯frpçš„ç‰ˆæœ¬é—®é¢˜ï¼Œäºæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ¢ä¸Šäº†æœ€æ–°çš„ç‰ˆæœ¬ï¼Œç»“æœè¿˜æ˜¯æ— æ³•è§£å†³é—®é¢˜ï¼Œç»§ç»­å°è¯•æ›´æ¢ç«¯å£ï¼Œé—®é¢˜ä¾æ—§ã€‚
ç½‘ä¸Šæœç´¢ä¸€åœˆï¼Œå‘ç°é‡åˆ°login to server failed: EOFé—®é¢˜çš„äººè¿˜çœŸä¸å°‘ï¼Œä¸‹é¢çœ‹çœ‹è€é«˜æ˜¯å¦‚ä½•è§£å†³çš„å§ï¼"><meta property="og:type" content="article"><meta property="og:url" content="https://phpgao.github.io/frp_tcp_reset.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-08-30T16:22:00+00:00"><meta property="article:modified_time" content="2019-08-30T16:22:00+00:00"><meta property="og:site_name" content="è€é«˜çš„æŠ€æœ¯åšå®¢"><meta name=twitter:card content="summary"><meta name=twitter:title content="è®°ä¸€æ¬¡frpçš„è¢«é˜»æ–­çš„é—®é¢˜"><meta name=twitter:description content="
ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„ç¨‹åºå‘˜ï¼Œåº”è¯¥æŠ±ç€åœ¨å“ªé‡Œéƒ½è¦åŠ ç­çš„ç†æƒ³ã€‚

ä¸ºäº†åœ¨å®¶è°ƒè¯•æ–¹ä¾¿ï¼Œè€é«˜ä½¿ç”¨frpå°†è‡ªå·±æ”¾åœ¨å…¬å¸çš„å¼€å‘æœºå™¨çš„sshç«¯å£å¼€æ”¾å‡ºæ¥äº†ï¼Œä½†æ˜¯é…ç½®frpå®¢æˆ·ç«¯çš„è¿‡ç¨‹ä¸­æ€»æ˜¯å‡ºç°ä¸‹é¢çš„ä¸€å¥è¯ï¼š
2019/08/30 23:42:47 [W] [service.go:82] login to server failed: EOF
EOF
å¼€å§‹æ€€ç–‘æ˜¯frpçš„ç‰ˆæœ¬é—®é¢˜ï¼Œäºæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ¢ä¸Šäº†æœ€æ–°çš„ç‰ˆæœ¬ï¼Œç»“æœè¿˜æ˜¯æ— æ³•è§£å†³é—®é¢˜ï¼Œç»§ç»­å°è¯•æ›´æ¢ç«¯å£ï¼Œé—®é¢˜ä¾æ—§ã€‚
ç½‘ä¸Šæœç´¢ä¸€åœˆï¼Œå‘ç°é‡åˆ°login to server failed: EOFé—®é¢˜çš„äººè¿˜çœŸä¸å°‘ï¼Œä¸‹é¢çœ‹çœ‹è€é«˜æ˜¯å¦‚ä½•è§£å†³çš„å§ï¼"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://phpgao.github.io/posts/"},{"@type":"ListItem","position":2,"name":"è®°ä¸€æ¬¡frpçš„è¢«é˜»æ–­çš„é—®é¢˜","item":"https://phpgao.github.io/frp_tcp_reset.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"è®°ä¸€æ¬¡frpçš„è¢«é˜»æ–­çš„é—®é¢˜","name":"è®°ä¸€æ¬¡frpçš„è¢«é˜»æ–­çš„é—®é¢˜","description":" ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„ç¨‹åºå‘˜ï¼Œåº”è¯¥æŠ±ç€åœ¨å“ªé‡Œéƒ½è¦åŠ ç­çš„ç†æƒ³ã€‚\n ä¸ºäº†åœ¨å®¶è°ƒè¯•æ–¹ä¾¿ï¼Œè€é«˜ä½¿ç”¨frpå°†è‡ªå·±æ”¾åœ¨å…¬å¸çš„å¼€å‘æœºå™¨çš„sshç«¯å£å¼€æ”¾å‡ºæ¥äº†ï¼Œä½†æ˜¯é…ç½®frpå®¢æˆ·ç«¯çš„è¿‡ç¨‹ä¸­æ€»æ˜¯å‡ºç°ä¸‹é¢çš„ä¸€å¥è¯ï¼š\n2019/08/30 23:42:47 [W] [service.go:82] login to server failed: EOF EOF å¼€å§‹æ€€ç–‘æ˜¯frpçš„ç‰ˆæœ¬é—®é¢˜ï¼Œäºæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ¢ä¸Šäº†æœ€æ–°çš„ç‰ˆæœ¬ï¼Œç»“æœè¿˜æ˜¯æ— æ³•è§£å†³é—®é¢˜ï¼Œç»§ç»­å°è¯•æ›´æ¢ç«¯å£ï¼Œé—®é¢˜ä¾æ—§ã€‚\nç½‘ä¸Šæœç´¢ä¸€åœˆï¼Œå‘ç°é‡åˆ°login to server failed: EOFé—®é¢˜çš„äººè¿˜çœŸä¸å°‘ï¼Œä¸‹é¢çœ‹çœ‹è€é«˜æ˜¯å¦‚ä½•è§£å†³çš„å§ï¼\n","keywords":["tcp","frp","kcp"],"articleBody":" ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„ç¨‹åºå‘˜ï¼Œåº”è¯¥æŠ±ç€åœ¨å“ªé‡Œéƒ½è¦åŠ ç­çš„ç†æƒ³ã€‚\n ä¸ºäº†åœ¨å®¶è°ƒè¯•æ–¹ä¾¿ï¼Œè€é«˜ä½¿ç”¨frpå°†è‡ªå·±æ”¾åœ¨å…¬å¸çš„å¼€å‘æœºå™¨çš„sshç«¯å£å¼€æ”¾å‡ºæ¥äº†ï¼Œä½†æ˜¯é…ç½®frpå®¢æˆ·ç«¯çš„è¿‡ç¨‹ä¸­æ€»æ˜¯å‡ºç°ä¸‹é¢çš„ä¸€å¥è¯ï¼š\n2019/08/30 23:42:47 [W] [service.go:82] login to server failed: EOF EOF å¼€å§‹æ€€ç–‘æ˜¯frpçš„ç‰ˆæœ¬é—®é¢˜ï¼Œäºæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ¢ä¸Šäº†æœ€æ–°çš„ç‰ˆæœ¬ï¼Œç»“æœè¿˜æ˜¯æ— æ³•è§£å†³é—®é¢˜ï¼Œç»§ç»­å°è¯•æ›´æ¢ç«¯å£ï¼Œé—®é¢˜ä¾æ—§ã€‚\nç½‘ä¸Šæœç´¢ä¸€åœˆï¼Œå‘ç°é‡åˆ°login to server failed: EOFé—®é¢˜çš„äººè¿˜çœŸä¸å°‘ï¼Œä¸‹é¢çœ‹çœ‹è€é«˜æ˜¯å¦‚ä½•è§£å†³çš„å§ï¼\næœ¬åœ°æŠ“åŒ… å¼€å¯Wiresharkï¼Œé€‰æ‹©ç½‘å¡ï¼Œè¾“å…¥è¿‡æ»¤è§„åˆ™ï¼š\ntcp and ip.addr==xxx.xxx.220.109 åé¢çš„é‚£ä¸‰ä¸ªRSTåŒ…å¾ˆå¯ç–‘ï¼Œå…¶ä¸­è¿˜æœ‰ä¸‰ä¸ªIRCåè®®çš„åŒ…ï¼Œæ‰“å¼€çœ‹ä¸€ä¸‹ï¼Œå‘ç°åŸæ¥æ˜¯è®¤è¯æ•°æ®ã€‚\n{\"version\":\"0.28.2\",\"hostname\":\"\",\"os\":\"darwin\",\"arch\":\"amd64\",\"user\":\"\",\"privilege_key\":\"144fa23b09635f403ccd18\",\"timestamp\":1567119104,\"run_id\":\"\",\"pool_count\":1} æœåŠ¡ç«¯æŠ“åŒ… æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥å‘½ä»¤\n# xxxx ä¸ºfrpç›‘å¬ç«¯å£ tcpdump -i eth0 port xxxx -n 23:57:54.041136 IP 180.167.229.162.64674  xx.xx.xx.xx.PPPP: Flags [S], seq 2454088299, win 65535, options [mss 1460,nop,wscale 6,nop,nop,TS val 1598952560 ecr 0,sackOK,eol], length 0 23:57:54.041203 IP xx.xx.xx.xx.PPPP  180.167.229.162.64674: Flags [S.], seq 2502814427, ack 2454088300, win 65160, options [mss 1460,sackOK,TS val 3508779989 ecr 1598952560,nop,wscale 6], length 0 23:57:54.171283 IP 180.167.229.162.64674  xx.xx.xx.xx.PPPP: Flags [.], ack 1, win 2058, options [nop,nop,TS val 1598952691 ecr 3508779989], length 0 23:57:54.171670 IP 180.167.229.162.64674  xx.xx.xx.xx.PPPP: Flags [P.], seq 1:13, ack 1, win 2058, options [nop,nop,TS val 1598952692 ecr 3508779989], length 12 23:57:54.171694 IP xx.xx.xx.xx.PPPP  180.167.229.162.64674: Flags [.], ack 13, win 1018, options [nop,nop,TS val 3508780120 ecr 1598952692], length 0 23:57:54.171896 IP xx.xx.xx.xx.PPPP  180.167.229.162.64674: Flags [P.], seq 1:13, ack 13, win 1018, options [nop,nop,TS val 3508780120 ecr 1598952692], length 12 23:57:54.172366 IP 180.167.229.162.64674  xx.xx.xx.xx.PPPP: Flags [P.], seq 13:25, ack 1, win 2058, options [nop,nop,TS val 1598952692 ecr 3508779989], length 12 23:57:54.172391 IP 180.167.229.162.64674  xx.xx.xx.xx.PPPP: Flags [R.], seq 25, ack 1, win 8224, length 0 23:57:54.301735 IP 180.167.229.162.64674  xx.xx.xx.xx.PPPP: Flags [R.], seq 13, ack 1, win 8224, length 0 23:57:54.302089 IP 180.167.229.162.64674  xx.xx.xx.xx.PPPP: Flags [R.], seq 13, ack 13, win 8224, length 0 å¥½å˜›ï¼Œæ³¨æ„æœ€åä¸‰ä¸ªåŒ…ï¼Œä¹Ÿæ˜¯RSTï¼Œè€Œä¸”æ–¹å‘åˆšå¥½å’Œæˆ‘åœ¨æœ¬åœ°æŠ“åŒ…ç›¸åï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯å—åˆ°äº†æ›¿èº«æ”»å‡»ï¼ğŸ˜„\nè§£å†³ çœ‹æ¥å…¬å¸çš„é˜²ç«å¢™åº”è¯¥æ˜¯æ¢æµ‹åˆ°äº†æŸäº›ç‰¹å¾æµé‡è€Œè§¦å‘äº†è§„åˆ™ï¼Œå¯¼è‡´frpè®¤è¯çš„åŒ…è¢«é‡ç½®ï¼Œäºæ˜¯æœåŠ¡ç«¯frpå…³é—­äº†é“¾æ¥ï¼Œè€Œç¿»å¼€æºç ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°å†å‘é€å®Œè®¤è¯ä¿¡æ¯åæ‰§è¡Œäº†ReadMsgIntoæ–¹æ³•ï¼Œå› ä¸ºè¿æ¥å·²ç»å…³é—­ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¾—åˆ°äº†EOFé”™è¯¯ï¼\nå›å¤´å†çœ‹wiresharkçš„RSTåŒ…ä¹‹å‰çš„ä¸‰ä¸ªIRCåŒ…ï¼Œç­‰ç­‰ï¼ŒIRCæ˜¯ä»€ä¹ˆé¬¼ï¼Ÿåœ¨FRPæºä»£ç ä¸­æ ¹æœ¬æœä¸åˆ°è¿™ä¸ªå…³é”®å­—å•Šï¼ä»æºä»£ç çš„ç™»å½•é€»è¾‘æ¥çœ‹ï¼ŒåŸºæœ¬éƒ½æ˜¯TCPçš„æ“ä½œã€‚äºæ˜¯å†è¯•ç€æŠ“ä¸€æ¬¡åŒ…ï¼ŒIRCåˆå˜å›äº†TCPï¼Œçœ‹æ¥wiresharkä¹Ÿæœ‰è¯¯æŠ¥çš„æƒ…å†µå‘ç”Ÿã€‚\nç©¶å…¶åŸå› ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯è¿™ä¸€æ®µæ˜æ–‡æ•°æ®æš´éœ²äº†frpï¼Œç„¶åå¯¼è‡´è¢«é˜²ç«å¢™å°æ€ã€‚\né‚£ä¹ˆå¦‚ä½•è§£å†³login to server failed: EOFçš„é—®é¢˜å‘¢ï¼Ÿ\nå…¶å®çœ‹äº†æºä»£ç å°±çŸ¥é“äº†ï¼ŒåŸæ¥frpåœ¨v0.25.0ç‰ˆæœ¬åå¢åŠ äº†ä¸€ä¸ªå®¢æˆ·ç«¯é€‰é¡¹ï¼Œæ”¯æŒäº†tlsä¼ è¾“ï¼Œä¹Ÿå°±æ˜¯ä¼ è¯´ä¸­çš„éå¯¹ç§°åŠ å¯†ï¼ŒåŸæ¥åœ¨frpsåˆå§‹åŒ–æœåŠ¡æ—¶ï¼Œåœ¨å†…å­˜ä¸­å·²ç»ä¸ºæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªç®€æ˜“çš„TLSæœåŠ¡ï¼Œç®€ç›´å®Œç¾ï¼\nå¼€å¯çš„åŠæ³•å¾ˆç®€å•ï¼Œåœ¨å®¢æˆ·ç«¯åŸæ¥çš„[common]é…ç½®ä¸­åŠ å…¥tls_enable = trueå³å¯!\nå¦ä¸€ç§è§£å†³åŠæ³• å…¶å®å˜›ï¼Œè¿˜æœ‰ä¸€ç§è§£å†³åŠæ³•ï¼Œä½†æ˜¯ä¸ä¸€å®šèƒ½è¡Œï¼Œè€Œä¸”å¯èƒ½ä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼\nä»€ä¹ˆæ–¹æ³•å‘¢ï¼Ÿæ—¢ç„¶é˜²ç«å¢™æ£€æµ‹äº†æˆ‘çš„tcpï¼Œé‚£æˆ‘æ¢æˆudpè¡Œä¸è¡Œï¼Ÿ\nfrpæ”¯æŒä½¿ç”¨kcpä½œä¸ºåº•å±‚çš„é€šè®¯åè®®ï¼Œè€Œkcpé»˜è®¤å°±æ˜¯åŸºäºudpåè®®ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œèµ¶ç´§è¯•ä¸€è¯•ï¼\næ­¥éª¤(å‡è®¾kcpçš„ç«¯å£ä¸º7000)ï¼š\n åœ¨æœåŠ¡ç«¯åŸæ¥çš„[common]é…ç½®ä¸­åŠ å…¥kcp_bind_port = 7000ï¼Œä½¿å…¶æ”¯æŒudp åœ¨å®¢æˆ·ç«¯åŸæ¥çš„[common]å¤„åŠ å…¥protocol = kcpå³å¯ï¼Œæ³¨æ„ç«¯å£ä¸€å®šè¦å¯¹ä¸Šï¼ ","wordCount":"251","inLanguage":"en","datePublished":"2019-08-30T16:22:00Z","dateModified":"2019-08-30T16:22:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://phpgao.github.io/frp_tcp_reset.html"},"publisher":{"@type":"Organization","name":"è€é«˜çš„æŠ€æœ¯åšå®¢","logo":{"@type":"ImageObject","url":"https://phpgao.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://phpgao.github.io/ accesskey=h title="è€é«˜çš„åšå®¢ (Alt + H)">è€é«˜çš„åšå®¢</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://phpgao.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://phpgao.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://blog.phpgao.com title="old blog"><span>old blog</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://phpgao.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://phpgao.github.io/posts/>Posts</a></div><h1 class=post-title>è®°ä¸€æ¬¡frpçš„è¢«é˜»æ–­çš„é—®é¢˜</h1><div class=post-meta>August 30, 2019&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/2019-08-30_frp_tcp_reset.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><blockquote><p>ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„ç¨‹åºå‘˜ï¼Œåº”è¯¥æŠ±ç€åœ¨å“ªé‡Œéƒ½è¦åŠ ç­çš„ç†æƒ³ã€‚</p></blockquote><p>ä¸ºäº†åœ¨å®¶è°ƒè¯•æ–¹ä¾¿ï¼Œè€é«˜ä½¿ç”¨frpå°†è‡ªå·±æ”¾åœ¨å…¬å¸çš„å¼€å‘æœºå™¨çš„sshç«¯å£å¼€æ”¾å‡ºæ¥äº†ï¼Œä½†æ˜¯é…ç½®frpå®¢æˆ·ç«¯çš„è¿‡ç¨‹ä¸­æ€»æ˜¯å‡ºç°ä¸‹é¢çš„ä¸€å¥è¯ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>2019/08/30 23:42:47 [W] [service.go:82] login to server failed: EOF
EOF
</code></pre></div><p>å¼€å§‹æ€€ç–‘æ˜¯frpçš„ç‰ˆæœ¬é—®é¢˜ï¼Œäºæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ¢ä¸Šäº†æœ€æ–°çš„ç‰ˆæœ¬ï¼Œç»“æœè¿˜æ˜¯æ— æ³•è§£å†³é—®é¢˜ï¼Œç»§ç»­å°è¯•æ›´æ¢ç«¯å£ï¼Œé—®é¢˜ä¾æ—§ã€‚</p><p>ç½‘ä¸Šæœç´¢ä¸€åœˆï¼Œå‘ç°é‡åˆ°<code>login to server failed: EOF</code>é—®é¢˜çš„äººè¿˜çœŸä¸å°‘ï¼Œä¸‹é¢çœ‹çœ‹è€é«˜æ˜¯å¦‚ä½•è§£å†³çš„å§ï¼</p><h2 id=æœ¬åœ°æŠ“åŒ…>æœ¬åœ°æŠ“åŒ…<a hidden class=anchor aria-hidden=true href=#æœ¬åœ°æŠ“åŒ…>#</a></h2><p>å¼€å¯Wiresharkï¼Œé€‰æ‹©ç½‘å¡ï¼Œè¾“å…¥è¿‡æ»¤è§„åˆ™ï¼š</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>tcp and ip.addr==xxx.xxx.220.109
</code></pre></div><p><img loading=lazy src=https://blog.phpgao.com/usr/uploads/2019/08/148061091.png alt="wireshark æŠ“åŒ…"></p><p>åé¢çš„é‚£ä¸‰ä¸ªRSTåŒ…<strong>å¾ˆå¯ç–‘</strong>ï¼Œå…¶ä¸­è¿˜æœ‰ä¸‰ä¸ªIRCåè®®çš„åŒ…ï¼Œæ‰“å¼€çœ‹ä¸€ä¸‹ï¼Œå‘ç°åŸæ¥æ˜¯è®¤è¯æ•°æ®ã€‚</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{<span style=color:#f92672>&#34;version&#34;</span>:<span style=color:#e6db74>&#34;0.28.2&#34;</span>,<span style=color:#f92672>&#34;hostname&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;os&#34;</span>:<span style=color:#e6db74>&#34;darwin&#34;</span>,<span style=color:#f92672>&#34;arch&#34;</span>:<span style=color:#e6db74>&#34;amd64&#34;</span>,<span style=color:#f92672>&#34;user&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;privilege_key&#34;</span>:<span style=color:#e6db74>&#34;144fa23b09635f403ccd18&#34;</span>,<span style=color:#f92672>&#34;timestamp&#34;</span>:<span style=color:#ae81ff>1567119104</span>,<span style=color:#f92672>&#34;run_id&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;pool_count&#34;</span>:<span style=color:#ae81ff>1</span>}
</code></pre></div><h2 id=æœåŠ¡ç«¯æŠ“åŒ…>æœåŠ¡ç«¯æŠ“åŒ…<a hidden class=anchor aria-hidden=true href=#æœåŠ¡ç«¯æŠ“åŒ…>#</a></h2><p>æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥å‘½ä»¤</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># xxxx ä¸ºfrpç›‘å¬ç«¯å£</span>
tcpdump -i eth0  port xxxx -n

23:57:54.041136 IP 180.167.229.162.64674 &gt; xx.xx.xx.xx.PPPP: Flags <span style=color:#f92672>[</span>S<span style=color:#f92672>]</span>, seq 2454088299, win 65535, options <span style=color:#f92672>[</span>mss 1460,nop,wscale 6,nop,nop,TS val <span style=color:#ae81ff>1598952560</span> ecr 0,sackOK,eol<span style=color:#f92672>]</span>, length <span style=color:#ae81ff>0</span>
23:57:54.041203 IP xx.xx.xx.xx.PPPP &gt; 180.167.229.162.64674: Flags <span style=color:#f92672>[</span>S.<span style=color:#f92672>]</span>, seq 2502814427, ack 2454088300, win 65160, options <span style=color:#f92672>[</span>mss 1460,sackOK,TS val <span style=color:#ae81ff>3508779989</span> ecr 1598952560,nop,wscale 6<span style=color:#f92672>]</span>, length <span style=color:#ae81ff>0</span>
23:57:54.171283 IP 180.167.229.162.64674 &gt; xx.xx.xx.xx.PPPP: Flags <span style=color:#f92672>[</span>.<span style=color:#f92672>]</span>, ack 1, win 2058, options <span style=color:#f92672>[</span>nop,nop,TS val <span style=color:#ae81ff>1598952691</span> ecr 3508779989<span style=color:#f92672>]</span>, length <span style=color:#ae81ff>0</span>
23:57:54.171670 IP 180.167.229.162.64674 &gt; xx.xx.xx.xx.PPPP: Flags <span style=color:#f92672>[</span>P.<span style=color:#f92672>]</span>, seq 1:13, ack 1, win 2058, options <span style=color:#f92672>[</span>nop,nop,TS val <span style=color:#ae81ff>1598952692</span> ecr 3508779989<span style=color:#f92672>]</span>, length <span style=color:#ae81ff>12</span>
23:57:54.171694 IP xx.xx.xx.xx.PPPP &gt; 180.167.229.162.64674: Flags <span style=color:#f92672>[</span>.<span style=color:#f92672>]</span>, ack 13, win 1018, options <span style=color:#f92672>[</span>nop,nop,TS val <span style=color:#ae81ff>3508780120</span> ecr 1598952692<span style=color:#f92672>]</span>, length <span style=color:#ae81ff>0</span>
23:57:54.171896 IP xx.xx.xx.xx.PPPP &gt; 180.167.229.162.64674: Flags <span style=color:#f92672>[</span>P.<span style=color:#f92672>]</span>, seq 1:13, ack 13, win 1018, options <span style=color:#f92672>[</span>nop,nop,TS val <span style=color:#ae81ff>3508780120</span> ecr 1598952692<span style=color:#f92672>]</span>, length <span style=color:#ae81ff>12</span>
23:57:54.172366 IP 180.167.229.162.64674 &gt; xx.xx.xx.xx.PPPP: Flags <span style=color:#f92672>[</span>P.<span style=color:#f92672>]</span>, seq 13:25, ack 1, win 2058, options <span style=color:#f92672>[</span>nop,nop,TS val <span style=color:#ae81ff>1598952692</span> ecr 3508779989<span style=color:#f92672>]</span>, length <span style=color:#ae81ff>12</span>
23:57:54.172391 IP 180.167.229.162.64674 &gt; xx.xx.xx.xx.PPPP: Flags <span style=color:#f92672>[</span>R.<span style=color:#f92672>]</span>, seq 25, ack 1, win 8224, length <span style=color:#ae81ff>0</span>
23:57:54.301735 IP 180.167.229.162.64674 &gt; xx.xx.xx.xx.PPPP: Flags <span style=color:#f92672>[</span>R.<span style=color:#f92672>]</span>, seq 13, ack 1, win 8224, length <span style=color:#ae81ff>0</span>
23:57:54.302089 IP 180.167.229.162.64674 &gt; xx.xx.xx.xx.PPPP: Flags <span style=color:#f92672>[</span>R.<span style=color:#f92672>]</span>, seq 13, ack 13, win 8224, length <span style=color:#ae81ff>0</span>
</code></pre></div><p>å¥½å˜›ï¼Œæ³¨æ„æœ€åä¸‰ä¸ªåŒ…ï¼Œä¹Ÿæ˜¯RSTï¼Œè€Œä¸”æ–¹å‘åˆšå¥½å’Œæˆ‘åœ¨æœ¬åœ°æŠ“åŒ…ç›¸åï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯å—åˆ°äº†æ›¿èº«æ”»å‡»ï¼ğŸ˜„</p><h2 id=è§£å†³>è§£å†³<a hidden class=anchor aria-hidden=true href=#è§£å†³>#</a></h2><p>çœ‹æ¥å…¬å¸çš„é˜²ç«å¢™åº”è¯¥æ˜¯æ¢æµ‹åˆ°äº†æŸäº›ç‰¹å¾æµé‡è€Œè§¦å‘äº†è§„åˆ™ï¼Œå¯¼è‡´frpè®¤è¯çš„åŒ…è¢«é‡ç½®ï¼Œäºæ˜¯æœåŠ¡ç«¯frpå…³é—­äº†é“¾æ¥ï¼Œè€Œç¿»å¼€<a href=https://github.com/fatedier/frp/blob/e62d9a52429f54dee8df1c42f2d4bad7a267b05d/client/service.go#L221>æºç </a>ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°å†å‘é€å®Œè®¤è¯ä¿¡æ¯åæ‰§è¡Œäº†<code>ReadMsgInto</code>æ–¹æ³•ï¼Œå› ä¸ºè¿æ¥å·²ç»å…³é—­ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¾—åˆ°äº†EOFé”™è¯¯ï¼</p><p>å›å¤´å†çœ‹wiresharkçš„RSTåŒ…ä¹‹å‰çš„ä¸‰ä¸ªIRCåŒ…ï¼Œç­‰ç­‰ï¼ŒIRCæ˜¯ä»€ä¹ˆé¬¼ï¼Ÿåœ¨FRPæºä»£ç ä¸­æ ¹æœ¬æœä¸åˆ°è¿™ä¸ªå…³é”®å­—å•Šï¼ä»æºä»£ç çš„ç™»å½•é€»è¾‘æ¥çœ‹ï¼ŒåŸºæœ¬éƒ½æ˜¯TCPçš„æ“ä½œã€‚äºæ˜¯å†è¯•ç€æŠ“ä¸€æ¬¡åŒ…ï¼ŒIRCåˆå˜å›äº†TCPï¼Œçœ‹æ¥wiresharkä¹Ÿæœ‰è¯¯æŠ¥çš„æƒ…å†µå‘ç”Ÿã€‚</p><p>ç©¶å…¶åŸå› ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯è¿™ä¸€æ®µæ˜æ–‡æ•°æ®æš´éœ²äº†frpï¼Œç„¶åå¯¼è‡´è¢«é˜²ç«å¢™å°æ€ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•è§£å†³<code>login to server failed: EOF</code>çš„é—®é¢˜å‘¢ï¼Ÿ</p><p>å…¶å®çœ‹äº†æºä»£ç å°±çŸ¥é“äº†ï¼ŒåŸæ¥frpåœ¨v0.25.0ç‰ˆæœ¬åå¢åŠ äº†ä¸€ä¸ªå®¢æˆ·ç«¯é€‰é¡¹ï¼Œæ”¯æŒäº†tlsä¼ è¾“ï¼Œä¹Ÿå°±æ˜¯ä¼ è¯´ä¸­çš„éå¯¹ç§°åŠ å¯†ï¼ŒåŸæ¥åœ¨frpsåˆå§‹åŒ–æœåŠ¡æ—¶ï¼Œåœ¨å†…å­˜ä¸­å·²ç»ä¸ºæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª<a href=https://github.com/fatedier/frp/blob/e62d9a52429f54dee8df1c42f2d4bad7a267b05d/server/service.go#L417>ç®€æ˜“çš„TLSæœåŠ¡</a>ï¼Œç®€ç›´å®Œç¾ï¼</p><p>å¼€å¯çš„åŠæ³•å¾ˆç®€å•ï¼Œåœ¨å®¢æˆ·ç«¯åŸæ¥çš„<code>[common]</code>é…ç½®ä¸­åŠ å…¥<code>tls_enable = true</code>å³å¯!</p><h2 id=å¦ä¸€ç§è§£å†³åŠæ³•>å¦ä¸€ç§è§£å†³åŠæ³•<a hidden class=anchor aria-hidden=true href=#å¦ä¸€ç§è§£å†³åŠæ³•>#</a></h2><p>å…¶å®å˜›ï¼Œè¿˜æœ‰ä¸€ç§è§£å†³åŠæ³•ï¼Œä½†æ˜¯ä¸ä¸€å®šèƒ½è¡Œï¼Œè€Œä¸”å¯èƒ½ä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼</p><p>ä»€ä¹ˆæ–¹æ³•å‘¢ï¼Ÿæ—¢ç„¶é˜²ç«å¢™æ£€æµ‹äº†æˆ‘çš„<code>tcp</code>ï¼Œé‚£æˆ‘æ¢æˆ<code>udp</code>è¡Œä¸è¡Œï¼Ÿ</p><p>frpæ”¯æŒä½¿ç”¨kcpä½œä¸ºåº•å±‚çš„é€šè®¯åè®®ï¼Œè€Œkcpé»˜è®¤å°±æ˜¯åŸºäº<code>udp</code>åè®®ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œèµ¶ç´§è¯•ä¸€è¯•ï¼</p><p>æ­¥éª¤(å‡è®¾kcpçš„ç«¯å£ä¸º7000)ï¼š</p><ol><li>åœ¨<strong>æœåŠ¡ç«¯</strong>åŸæ¥çš„<code>[common]</code>é…ç½®ä¸­åŠ å…¥<code>kcp_bind_port = 7000</code>ï¼Œä½¿å…¶æ”¯æŒudp</li><li>åœ¨<strong>å®¢æˆ·ç«¯</strong>åŸæ¥çš„<code>[common]</code>å¤„åŠ å…¥<code>protocol = kcp</code>å³å¯ï¼Œæ³¨æ„ç«¯å£ä¸€å®šè¦å¯¹ä¸Šï¼</li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://phpgao.github.io/tags/tcp/>tcp</a></li><li><a href=https://phpgao.github.io/tags/frp/>frp</a></li><li><a href=https://phpgao.github.io/tags/kcp/>kcp</a></li></ul><nav class=paginav><a class=prev href=https://phpgao.github.io/vps_tinyproxy.html><span class=title>Â« Prev Page</span><br><span>ç©è½¬VPSä¹‹å¿«é€Ÿæ­å»ºHTTPä»£ç†</span></a>
<a class=next href=https://phpgao.github.io/puppeteer_basic_settings.html><span class=title>Next Page Â»</span><br><span>puppeteerçš„ä½¿ç”¨æ•™ç¨‹2---æ›´å¤šè®¾ç½®</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://phpgao.github.io/>è€é«˜çš„æŠ€æœ¯åšå®¢</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>