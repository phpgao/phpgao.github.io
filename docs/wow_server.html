<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>从零开始编译wow私服 | 老高的技术博客</title><meta name=keywords content><meta name=description content="自从魔兽世界开始转为月卡时，老高就基本AFK了。。。直到偶然听到歌单里的灰熊丘陵、风暴群山的BGM，又一次的手痒了，不过这次我们不冲点卡，我们以学习的态度搭建一个专属自己的魔兽世界服务器！"><meta name=author content="Me"><link rel=canonical href=https://phpgao.github.io/wow_server.html><link crossorigin=anonymous href=/assets/css/stylesheet.min.1a6ee89730e13a801d0f34e0cb5b98e96cf8c65b80500638bd599fc224ed8442.css integrity="sha256-Gm7olzDhOoAdDzTgy1uY6Wz4xluAUAY4vVmfwiTthEI=" rel="preload stylesheet" as=style><link rel=preload href="https://cdn.v2ex.com/gravatar/2b66f45a3e2f41db6522381006bfaea1?s=192" as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://phpgao.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://phpgao.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://phpgao.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://phpgao.github.io/apple-touch-icon.png><link rel=mask-icon href=https://phpgao.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-39288145-2','auto'),ga('send','pageview'))</script><meta property="og:title" content="从零开始编译wow私服"><meta property="og:description" content="自从魔兽世界开始转为月卡时，老高就基本AFK了。。。直到偶然听到歌单里的灰熊丘陵、风暴群山的BGM，又一次的手痒了，不过这次我们不冲点卡，我们以学习的态度搭建一个专属自己的魔兽世界服务器！"><meta property="og:type" content="article"><meta property="og:url" content="https://phpgao.github.io/wow_server.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-07-27T08:30:00+00:00"><meta property="article:modified_time" content="2019-07-27T08:30:00+00:00"><meta property="og:site_name" content="老高的技术博客"><meta name=twitter:card content="summary"><meta name=twitter:title content="从零开始编译wow私服"><meta name=twitter:description content="自从魔兽世界开始转为月卡时，老高就基本AFK了。。。直到偶然听到歌单里的灰熊丘陵、风暴群山的BGM，又一次的手痒了，不过这次我们不冲点卡，我们以学习的态度搭建一个专属自己的魔兽世界服务器！"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://phpgao.github.io/posts/"},{"@type":"ListItem","position":2,"name":"从零开始编译wow私服","item":"https://phpgao.github.io/wow_server.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"从零开始编译wow私服","name":"从零开始编译wow私服","description":"自从魔兽世界开始转为月卡时，老高就基本AFK了。。。直到偶然听到歌单里的灰熊丘陵、风暴群山的BGM，又一次的手痒了，不过这次我们不冲点卡，我们以学习的态度搭建一个专属自己的魔兽世界服务器！\n","keywords":[],"articleBody":"自从魔兽世界开始转为月卡时，老高就基本AFK了。。。直到偶然听到歌单里的灰熊丘陵、风暴群山的BGM，又一次的手痒了，不过这次我们不冲点卡，我们以学习的态度搭建一个专属自己的魔兽世界服务器！\n 感谢TrinityCore项目，你们懂得！\n 说明 本文只针对3.3.5版本，master版本请参考官方文档。\n老高的运行环境是 Debian 9，当然会docker的同学可以随意选择系统。 硬件配置\n i3 8g 200G ssd   编译TrinityCore是一个比较漫长的过程，需要投入一定的时间和精力才能完成！\n 安装步骤基本都是参考Installation Guide - TrinityCore - TrinityCore Collaboration Platform这个页面，英文水平好的同学可以直接参考。\n关于版本 在TrinityCore中我们能看到master版本和3.3.5两个版本，他们有什么不同呢？其实很简单。\n master是最新的wow服务器版本，理论上可以用当前的国服的客户端直接登陆，只需要做一些轻微的改动，但是由于比较新的缘故，bug也会很多，而基本上每次bug修复都需要重新编译整个服务器，所以官方不推荐使用master分支的代码。 3.3.5 官方推荐版本，虽然BUGFiX的提交也不少，但是提交的基本都是SQL，所以稳妥起见还是老老实实用这个版本吧！  关于Windows系统 由于老高多余的服务器刚好跑了OMV，基于Debian9，所以就顺势用了这个机子。win上的编译可能会麻烦一些，如果有需求，后期再上教程！\n准备工作 依赖安装 apt-get update apt-get install git clang cmake make gcc g++ libmariadbclient-dev libssl-dev libbz2-dev libreadline-dev libncurses-dev libboost-all-dev mariadb-server p7zip default-libmysqlclient-dev update-alternatives --install /usr/bin/cc cc /usr/bin/clang 100 update-alternatives --install /usr/bin/c++ c++ /usr/bin/clang 100 创建用户 用户名为wow\nadduser wow su - wow 约定目录 以下是老高的建议目录\n# 以wow权限执行 su - wow # TrinityCore 目录 mkdir /home/wow/TrinityCore # 服务器目录，最终包含etc,bin,data三个子目录 mkdir /home/wow/server355 # 客户端目录 mkdir /home/wow/client 下载工作 既然是网络游戏，那就一定需要C端和S端，即客户端和服务器端，需要注意的是：\n 必须需要下载的必须是3.3.5(12340)的版本，其他版本可能会出现无法验证游戏版本，这可能是由于档案已经被破坏或是其他的问题，可能需要通过改源码重新编译的手段才能完成登录！所以一定不要下错版本了！ S端优先下载，下载完后先编译  S端 # 以wow用户执行 git clone -b 3.3.5 git://github.com/TrinityCore/TrinityCore.git /home/wow/TrinityCore C端 客户端版本：3.3.5(12340)\n 客户端下载地址1(老高使用的版本)： https://pan.baidu.com/s/1o8TkZOY 密码: kqcd 客户端下载地址2(待验证)： https://pan.baidu.com/s/13C__Fm8_rkoqB6mu7dfz_Q  百度盘下载很慢，需要自己想办法，下载解压后，需要把完成后把文件上传到Linux服务器上，用于后续步骤。\n编译服务端 权限建议: wow\n编译期间可以先跳过提取客户端信息，阅读准备数据库章节!\ncd /home/wow/TrinityCore mkdir build cd build cmake ../ -DCMAKE_INSTALL_PREFIX=/home/wow/server355 # 此步骤可能时间比较长，可以用nohup或者screen执行 make -j $(nproc) install # 终于，你编译好了服务端，胜利不远了！ 编译完成后，/home/wow/server355目录下会出现 etc和bin目录\n# ls /home/wow/server355/bin -rwxr-xr-x 1 wow wow 25104168 Jul 26 00:17 authserver -rwxr-xr-x 1 wow wow 3361976 Jul 26 00:17 mapextractor -rwxr-xr-x 1 wow wow 19130160 Jul 26 00:17 mmaps_generator -rwxr-xr-x 1 wow wow 10167776 Jul 26 00:17 vmap4assembler -rwxr-xr-x 1 wow wow 8489448 Jul 26 00:17 vmap4extractor -rwxr-xr-x 1 wow wow 587311088 Jul 26 00:36 worldserver # ls /home/wow/server355/bin -rw-r--r-- 1 wow wow 13K Jul 25 23:42 authserver.conf.dist drwxr-xr-x 2 wow wow 156K Jul 27 00:15 maps drwxr-xr-x 2 wow wow 132K Jul 27 00:15 mmaps drwxr-xr-x 2 wow wow 536K Jul 27 00:15 vmaps -rw-r--r-- 1 wow wow 133K Jul 26 00:16 worldserver.conf.dist 我们顺手把worldserver.conf.dist和authserver.conf.dist复制一份，然后修改worldserver.conf中 DataDir = \".\" 为 DataDir = \"../data\"，修改方法在此不赘述，可以用vi命令，也可以在win下改好放上去。\ncp /home/wow/server355/bin/worldserver.conf.dist worldserver.conf cp /home/wow/server355/bin/authserver.conf.dist authserver.conf 提取客户端信息 权限建议: wow\n此步骤依赖：\n 客户端文件 编译好的TrinityCore  DBC and Maps files cd /home/wow/client /home/wow/server355/bin/mapextractor mkdir /home/wow/server355/data cp -r dbc maps /home/wow/server355/data Visual Maps (aka vmaps) cd /home/wow/client /home/wow/server355/bin/vmap4extractor mkdir vmaps /home/wow/server355/bin/vmap4assembler Buildings vmaps cp -r vmaps /home/wow/server355/data Movement Maps (aka mmaps) cd /home/wow/client mkdir mmaps /home/wow/server355/bin/mmaps_generator cp -r mmaps /home/wow/server355/data  好了，终于胜利就在前方！\n 准备数据库 数据库存放了游戏的各种信息，所以在启动服务器钱，我们需要把数据库搭建好！由于在依赖处理步骤中我们已经安装了mariadb-server，所以现在我们只需要运行它即可！\n 此节需要root权限\n 运行数据库 systemctl enable mysql systemctl restart mysql 如果没有报错，我们接着执行初始化脚本，这里我们需要为root用户提供一个密码，这里假设为 laogaoniubi\n初始化 权限建议: root\nmysql_secure_installation # Enter current password for root (enter for none): 输入回车 # Change the root password? [Y/n] Y # 输入两次 laogaoniubi # Remove anonymous users? [Y/n] Y # Disallow root login remotely? [Y/n] # Y表示让root用户远程登录，N表示可以远程登录，老高推荐董数据库的同学选Y，觉得自己搞不定或者搞不懂的请选N Y Remove test database and access to it? [Y/n] Y Reload privilege tables now? [Y/n] Y 至此，我们已经成功初始化数据库，并且成功将root用户的密码设置为laogaoniubi！\n导入数据 第一步是把数据库建立起来，我们需要执行以下sql，sql的路径位于源码的TrinityCore/sql/create/create_mysql.sql\nGRANT USAGE ON * . * TO 'trinity'@'localhost' IDENTIFIED BY 'trinity' WITH MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 ; CREATE DATABASE `world` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; CREATE DATABASE `characters` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; CREATE DATABASE `auth` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci; GRANT ALL PRIVILEGES ON `world` . * TO 'trinity'@'localhost' WITH GRANT OPTION; GRANT ALL PRIVILEGES ON `characters` . * TO 'trinity'@'localhost' WITH GRANT OPTION; GRANT ALL PRIVILEGES ON `auth` . * TO 'trinity'@'localhost' WITH GRANT OPTION; 执行方法参考：\n# 登录 mysql后执行 source /home/wow/TrinityCore/sql/create/create_mysql.sql 至此，数据库初始化完毕\n 数据库你都能搞定，是个人才！要不要加个好友认识一下？\n 配置网络 让我们打开数据库auth，查看一下表realmlist，让我们把address字段改为服务器的IP，老高的服务器IP为192.168.111.111。\n(`id`, `name`, `address`, `localAddress`, `localSubnetMask`, `port`, `icon`, `flag`, `timezone`, `allowedSecurityLevel`, `population`, `gamebuild`) VALUES ('1', 'Trinity', '192.168.111.116', '192.168.111.111', '255.255.255.0', '8085', '0', '0', '1', '0', '0', '12340'); 最后的服务配置 权限: wow\n 不要急，胜利已经是你的了！\n 之前的准备工作在这一步汇总，到收获的季节了！\nauthserver  可以公开的情报：authserver即认证服务，我们登陆账户都是到这里认证后才会请求worldserver，也就是说authserver只有在登陆的时候才起作用，登录后这个进程就可以关闭了！\n 我们先运行authserver看看 /home/wow/server355/bin/authserver # or /home/wow/server355/bin/authserver -c /home/wow/server355/etc/authserver.conf 以下输出即为成功，很不错！\nDatabasePool 'auth' opened successfully. 2 total connections running. Started auth database connection pool. Loading IP Location Database... Added realm \"Trinity\" at 192.168.111.111:8085. worldserver /home/wow/server355/bin/worldserver 以下输出即为。。。什么！竟然又报错了！看来之前少下载了一个文件，名字叫TDB_full_world_335.19071_2019_07_15.sql，这个文件在哪里下载呢？\n下载传送门，请对号入座\n下载下来的文件后缀为7z，我们需要先解压，得到sql文件后直接放在/home/wow/server355/bin/worldserver的同级目录即可！\n再一次，我们运行worldserver，如果得到以下输出，那么恭喜你，你已经沐浴到胜利的阳光了！\nWorld initialized in 0 minutes 8 seconds TrinityCore rev. 7e10438b2759 2019-07-25 17:00:03 +0200 (3.3.5 branch) (Unix, RelWithDebInfo, Static) (worldserver-daemon) ready... TCTC 添加账号 上一节我们终于进入了worldserver，下面我们给我们的主角创建一个NO1的账号，使用以下命令格式\naccount create   World initialized in 0 minutes 8 seconds TrinityCore rev. 7e10438b2759 2019-07-25 17:00:03 +0200 (3.3.5 branch) (Unix, RelWithDebInfo, Static) (worldserver-daemon) ready... # 这里我们创建了一个用户名为test，密码也为test的账户 TCTC account create test test # 紧接着我们把test账户升级为gm，豪嘛！这老NB了！ TCTC account set gmlevel test 3 -1 登录 让我们回到Windows的怀抱，跑到wow客户端下，把下面的代码保存为wow.bat并执行，别管360的提醒，直接允许。\necho y | rd /s \"Cache\" echo SET realmlist \"192.168.111.111\"  Data\\zhTW\\realmlist.wtf echo SET realmlist \"192.168.111.111\"  Data\\enTW\\realmlist.wtf echo SET realmlist \"192.168.111.111\"  Data\\zhCN\\realmlist.wtf echo SET realmlist \"192.168.111.111\"  Data\\enCN\\realmlist.wtf echo SET realmlist \"192.168.111.111\"  Data\\enUS\\realmlist.wtf echo SET realmlist \"192.168.111.111\"  realmlist.wtf start Wow.exe goto end 幽灵虎。。。\n参考  https://trinitycore.atlassian.net/wiki/spaces/tc/pages/10977288/Linux+Requirements https://trinitycore.atlassian.net/wiki/spaces/tc/pages/2130065/GM+Commands https://xspio.com/%E9%AD%94%E5%85%BD%E4%B8%96%E7%95%8C%E5%AE%98%E6%96%B9%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%8B%E8%BD%BD ","wordCount":"647","inLanguage":"en","datePublished":"2019-07-27T08:30:00Z","dateModified":"2019-07-27T08:30:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://phpgao.github.io/wow_server.html"},"publisher":{"@type":"Organization","name":"老高的技术博客","logo":{"@type":"ImageObject","url":"https://phpgao.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://phpgao.github.io/ accesskey=h title="老高的博客 (Alt + H)">老高的博客</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://phpgao.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://phpgao.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://blog.phpgao.com title="old blog"><span>old blog</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://phpgao.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://phpgao.github.io/posts/>Posts</a></div><h1 class=post-title>从零开始编译wow私服</h1><div class=post-meta>July 27, 2019&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/2019-07-27_wow_server.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>自从魔兽世界开始转为月卡时，老高就基本AFK了。。。直到偶然听到歌单里的灰熊丘陵、风暴群山的BGM，又一次的手痒了，不过这次我们不冲点卡，我们以学习的态度搭建一个专属自己的魔兽世界服务器！</p><blockquote><p>感谢<a href=https://www.trinitycore.org/>TrinityCore</a>项目，你们懂得！</p></blockquote><h2 id=说明>说明<a hidden class=anchor aria-hidden=true href=#说明>#</a></h2><p>本文只针对3.3.5版本，master版本请参考官方文档。</p><p>老高的运行环境是 Debian 9，当然会docker的同学可以随意选择系统。
硬件配置</p><ul><li>i3</li><li>8g</li><li>200G ssd</li></ul><blockquote><p>编译TrinityCore是一个比较漫长的过程，需要投入一定的时间和精力才能完成！</p></blockquote><p>安装步骤基本都是参考<a href=https://trinitycore.atlassian.net/wiki/spaces/tc/pages/2130077/Installation+Guide>Installation Guide - TrinityCore - TrinityCore Collaboration Platform</a>这个页面，英文水平好的同学可以直接参考。</p><h3 id=关于版本>关于版本<a hidden class=anchor aria-hidden=true href=#关于版本>#</a></h3><p>在TrinityCore中我们能看到master版本和3.3.5两个版本，他们有什么不同呢？其实很简单。</p><ul><li>master是最新的wow服务器版本，理论上可以用当前的国服的客户端直接登陆，只需要做一些轻微的改动，但是由于比较新的缘故，bug也会很多，而基本上每次bug修复都需要重新编译整个服务器，所以官方不推荐使用master分支的代码。</li><li>3.3.5 官方推荐版本，虽然BUGFiX的提交也不少，但是提交的基本都是SQL，所以稳妥起见还是老老实实用这个版本吧！</li></ul><h3 id=关于windows系统>关于Windows系统<a hidden class=anchor aria-hidden=true href=#关于windows系统>#</a></h3><p>由于老高多余的服务器刚好跑了OMV，基于Debian9，所以就顺势用了这个机子。win上的编译可能会麻烦一些，如果有需求，后期再上教程！</p><h2 id=准备工作>准备工作<a hidden class=anchor aria-hidden=true href=#准备工作>#</a></h2><h3 id=依赖安装>依赖安装<a hidden class=anchor aria-hidden=true href=#依赖安装>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>apt-get update
apt-get install git clang cmake make gcc g++ libmariadbclient-dev libssl-dev libbz2-dev libreadline-dev libncurses-dev libboost-all-dev mariadb-server p7zip default-libmysqlclient-dev
update-alternatives --install /usr/bin/cc cc /usr/bin/clang <span style=color:#ae81ff>100</span>
update-alternatives --install /usr/bin/c++ c++ /usr/bin/clang <span style=color:#ae81ff>100</span>
</code></pre></div><h3 id=创建用户>创建用户<a hidden class=anchor aria-hidden=true href=#创建用户>#</a></h3><p>用户名为wow</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>adduser wow
su - wow
</code></pre></div><h3 id=约定目录>约定目录<a hidden class=anchor aria-hidden=true href=#约定目录>#</a></h3><p>以下是老高的建议目录</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># 以wow权限执行</span>
su - wow
<span style=color:#75715e># TrinityCore 目录</span>
mkdir /home/wow/TrinityCore

<span style=color:#75715e># 服务器目录，最终包含etc,bin,data三个子目录</span>
mkdir /home/wow/server355

<span style=color:#75715e># 客户端目录</span>
mkdir /home/wow/client
</code></pre></div><h2 id=下载工作>下载工作<a hidden class=anchor aria-hidden=true href=#下载工作>#</a></h2><p>既然是网络游戏，那就一定需要C端和S端，即客户端和服务器端，需要注意的是：</p><ol><li>必须需要下载的必须是3.3.5(12340)的版本，其他版本可能会出现<code>无法验证游戏版本，这可能是由于档案已经被破坏或是其他</code>的问题，可能需要通过改源码重新编译的手段才能完成登录！所以一定不要下错版本了！</li><li>S端优先下载，下载完后先编译</li></ol><h3 id=s端>S端<a hidden class=anchor aria-hidden=true href=#s端>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># 以wow用户执行</span>
git clone -b 3.3.5 git://github.com/TrinityCore/TrinityCore.git /home/wow/TrinityCore
</code></pre></div><h3 id=c端>C端<a hidden class=anchor aria-hidden=true href=#c端>#</a></h3><p>客户端版本：3.3.5(12340)</p><ul><li>客户端下载地址1(老高使用的版本)： <a href=https://pan.baidu.com/s/1o8TkZOY>https://pan.baidu.com/s/1o8TkZOY</a> 密码: kqcd</li><li>客户端下载地址2(待验证)： <a href=https://pan.baidu.com/s/13C__Fm8_rkoqB6mu7dfz_Q>https://pan.baidu.com/s/13C__Fm8_rkoqB6mu7dfz_Q</a></li></ul><p>百度盘下载很慢，需要自己想办法，下载解压后，需要把完成后把文件上传到Linux服务器上，用于后续步骤。</p><h2 id=编译服务端>编译服务端<a hidden class=anchor aria-hidden=true href=#编译服务端>#</a></h2><p>权限建议: wow</p><p>编译期间可以先跳过<code>提取客户端信息</code>，阅读<code>准备数据库</code>章节!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cd /home/wow/TrinityCore
mkdir build
cd build
cmake ../ -DCMAKE_INSTALL_PREFIX<span style=color:#f92672>=</span>/home/wow/server355
<span style=color:#75715e># 此步骤可能时间比较长，可以用nohup或者screen执行</span>
make -j <span style=color:#66d9ef>$(</span>nproc<span style=color:#66d9ef>)</span> install

<span style=color:#75715e># 终于，你编译好了服务端，胜利不远了！</span>
</code></pre></div><p>编译完成后，/home/wow/server355目录下会出现 etc和bin目录</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># ls /home/wow/server355/bin</span>
-rwxr-xr-x <span style=color:#ae81ff>1</span> wow  wow   <span style=color:#ae81ff>25104168</span> Jul <span style=color:#ae81ff>26</span> 00:17 authserver
-rwxr-xr-x <span style=color:#ae81ff>1</span> wow  wow    <span style=color:#ae81ff>3361976</span> Jul <span style=color:#ae81ff>26</span> 00:17 mapextractor
-rwxr-xr-x <span style=color:#ae81ff>1</span> wow  wow   <span style=color:#ae81ff>19130160</span> Jul <span style=color:#ae81ff>26</span> 00:17 mmaps_generator
-rwxr-xr-x <span style=color:#ae81ff>1</span> wow  wow   <span style=color:#ae81ff>10167776</span> Jul <span style=color:#ae81ff>26</span> 00:17 vmap4assembler
-rwxr-xr-x <span style=color:#ae81ff>1</span> wow  wow    <span style=color:#ae81ff>8489448</span> Jul <span style=color:#ae81ff>26</span> 00:17 vmap4extractor
-rwxr-xr-x <span style=color:#ae81ff>1</span> wow  wow  <span style=color:#ae81ff>587311088</span> Jul <span style=color:#ae81ff>26</span> 00:36 worldserver

<span style=color:#75715e># ls /home/wow/server355/bin</span>
-rw-r--r-- <span style=color:#ae81ff>1</span> wow wow  13K Jul <span style=color:#ae81ff>25</span> 23:42 authserver.conf.dist
drwxr-xr-x <span style=color:#ae81ff>2</span> wow wow 156K Jul <span style=color:#ae81ff>27</span> 00:15 maps
drwxr-xr-x <span style=color:#ae81ff>2</span> wow wow 132K Jul <span style=color:#ae81ff>27</span> 00:15 mmaps
drwxr-xr-x <span style=color:#ae81ff>2</span> wow wow 536K Jul <span style=color:#ae81ff>27</span> 00:15 vmaps
-rw-r--r-- <span style=color:#ae81ff>1</span> wow wow 133K Jul <span style=color:#ae81ff>26</span> 00:16 worldserver.conf.dist
</code></pre></div><p>我们顺手把<strong>worldserver.conf.dist</strong>和<strong>authserver.conf.dist</strong>复制一份，然后修改<strong>worldserver.conf</strong>中 <code>DataDir = "."</code> 为 <code>DataDir = "../data"</code>，修改方法在此不赘述，可以用vi命令，也可以在win下改好放上去。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cp /home/wow/server355/bin/worldserver.conf.dist worldserver.conf
cp /home/wow/server355/bin/authserver.conf.dist authserver.conf
</code></pre></div><h2 id=提取客户端信息>提取客户端信息<a hidden class=anchor aria-hidden=true href=#提取客户端信息>#</a></h2><p>权限建议: wow</p><p>此步骤依赖：</p><ol><li>客户端文件</li><li>编译好的TrinityCore</li></ol><h3 id=dbc-and-maps-files>DBC and Maps files<a hidden class=anchor aria-hidden=true href=#dbc-and-maps-files>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cd /home/wow/client
/home/wow/server355/bin/mapextractor
mkdir /home/wow/server355/data
  
cp -r dbc maps /home/wow/server355/data
</code></pre></div><h3 id=visual-maps-aka-vmaps>Visual Maps (aka vmaps)<a hidden class=anchor aria-hidden=true href=#visual-maps-aka-vmaps>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cd /home/wow/client
/home/wow/server355/bin/vmap4extractor
mkdir vmaps
/home/wow/server355/bin/vmap4assembler Buildings vmaps
cp -r vmaps /home/wow/server355/data
</code></pre></div><h3 id=movement-maps-aka-mmaps>Movement Maps (aka mmaps)<a hidden class=anchor aria-hidden=true href=#movement-maps-aka-mmaps>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cd /home/wow/client
mkdir mmaps
/home/wow/server355/bin/mmaps_generator
cp -r mmaps /home/wow/server355/data
</code></pre></div><blockquote><p>好了，终于胜利就在前方！</p></blockquote><h2 id=准备数据库>准备数据库<a hidden class=anchor aria-hidden=true href=#准备数据库>#</a></h2><p>数据库存放了游戏的各种信息，所以在启动服务器钱，我们需要把数据库搭建好！由于在依赖处理步骤中我们已经安装了<code>mariadb-server</code>，所以现在我们只需要运行它即可！</p><blockquote><p>此节需要root权限</p></blockquote><h3 id=运行数据库>运行数据库<a hidden class=anchor aria-hidden=true href=#运行数据库>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>systemctl enable mysql
systemctl restart mysql
</code></pre></div><p>如果没有报错，我们接着执行初始化脚本，这里我们需要为root用户提供一个密码，这里假设为 laogaoniubi</p><h3 id=初始化>初始化<a hidden class=anchor aria-hidden=true href=#初始化>#</a></h3><p>权限建议: root</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mysql_secure_installation

<span style=color:#75715e># Enter current password for root (enter for none):</span>
输入回车

<span style=color:#75715e># Change the root password? [Y/n]</span>
Y

<span style=color:#75715e># 输入两次 laogaoniubi</span>

<span style=color:#75715e># Remove anonymous users? [Y/n]</span>
Y

<span style=color:#75715e># Disallow root login remotely? [Y/n]</span>
<span style=color:#75715e># Y表示让root用户远程登录，N表示可以远程登录，老高推荐董数据库的同学选Y，觉得自己搞不定或者搞不懂的请选N</span>
Y

Remove test database and access to it? <span style=color:#f92672>[</span>Y/n<span style=color:#f92672>]</span>
Y

Reload privilege tables now? <span style=color:#f92672>[</span>Y/n<span style=color:#f92672>]</span>
Y
</code></pre></div><p>至此，我们已经成功初始化数据库，并且成功将root用户的密码设置为laogaoniubi！</p><h3 id=导入数据>导入数据<a hidden class=anchor aria-hidden=true href=#导入数据>#</a></h3><p>第一步是把数据库建立起来，我们需要执行以下sql，sql的路径位于源码的<a href=https://github.com/TrinityCore/TrinityCore/blob/3.3.5/sql/create/create_mysql.sql>TrinityCore/sql/create/create_mysql.sql</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>USAGE</span> <span style=color:#66d9ef>ON</span> <span style=color:#f92672>*</span> . <span style=color:#f92672>*</span> <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;trinity&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span> IDENTIFIED <span style=color:#66d9ef>BY</span> <span style=color:#e6db74>&#39;trinity&#39;</span> <span style=color:#66d9ef>WITH</span> MAX_QUERIES_PER_HOUR <span style=color:#ae81ff>0</span> MAX_CONNECTIONS_PER_HOUR <span style=color:#ae81ff>0</span> MAX_UPDATES_PER_HOUR <span style=color:#ae81ff>0</span> ;

<span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DATABASE</span> <span style=color:#f92672>`</span>world<span style=color:#f92672>`</span> <span style=color:#66d9ef>DEFAULT</span> CHARACTER <span style=color:#66d9ef>SET</span> utf8 <span style=color:#66d9ef>COLLATE</span> utf8_general_ci;

<span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DATABASE</span> <span style=color:#f92672>`</span>characters<span style=color:#f92672>`</span> <span style=color:#66d9ef>DEFAULT</span> CHARACTER <span style=color:#66d9ef>SET</span> utf8 <span style=color:#66d9ef>COLLATE</span> utf8_general_ci;

<span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DATABASE</span> <span style=color:#f92672>`</span>auth<span style=color:#f92672>`</span> <span style=color:#66d9ef>DEFAULT</span> CHARACTER <span style=color:#66d9ef>SET</span> utf8 <span style=color:#66d9ef>COLLATE</span> utf8_general_ci;

<span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>ALL</span> <span style=color:#66d9ef>PRIVILEGES</span> <span style=color:#66d9ef>ON</span> <span style=color:#f92672>`</span>world<span style=color:#f92672>`</span> . <span style=color:#f92672>*</span> <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;trinity&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span> <span style=color:#66d9ef>WITH</span> <span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>OPTION</span>;

<span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>ALL</span> <span style=color:#66d9ef>PRIVILEGES</span> <span style=color:#66d9ef>ON</span> <span style=color:#f92672>`</span>characters<span style=color:#f92672>`</span> . <span style=color:#f92672>*</span> <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;trinity&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span> <span style=color:#66d9ef>WITH</span> <span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>OPTION</span>;

<span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>ALL</span> <span style=color:#66d9ef>PRIVILEGES</span> <span style=color:#66d9ef>ON</span> <span style=color:#f92672>`</span>auth<span style=color:#f92672>`</span> . <span style=color:#f92672>*</span> <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;trinity&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span> <span style=color:#66d9ef>WITH</span> <span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>OPTION</span>;
</code></pre></div><p>执行方法参考：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># 登录 mysql后执行</span>

source /home/wow/TrinityCore/sql/create/create_mysql.sql
</code></pre></div><p>至此，数据库初始化完毕</p><blockquote><p>数据库你都能搞定，是个人才！要不要加个好友认识一下？</p></blockquote><h2 id=配置网络>配置网络<a hidden class=anchor aria-hidden=true href=#配置网络>#</a></h2><p>让我们打开数据库<code>auth</code>，查看一下表<code>realmlist</code>，让我们把<code>address</code>字段改为服务器的IP，老高的服务器IP为<code>192.168.111.111</code>。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>(`id`, `name`, `address`, `localAddress`, `localSubnetMask`, `port`, `icon`, `flag`, `timezone`, `allowedSecurityLevel`, `population`, `gamebuild`) VALUES (&#39;1&#39;, &#39;Trinity&#39;, &#39;192.168.111.116&#39;, &#39;192.168.111.111&#39;, &#39;255.255.255.0&#39;, &#39;8085&#39;, &#39;0&#39;, &#39;0&#39;, &#39;1&#39;, &#39;0&#39;, &#39;0&#39;, &#39;12340&#39;);

</code></pre></div><h2 id=最后的服务配置>最后的服务配置<a hidden class=anchor aria-hidden=true href=#最后的服务配置>#</a></h2><p>权限: wow</p><blockquote><p>不要急，胜利已经是你的了！</p></blockquote><p>之前的准备工作在这一步汇总，到收获的季节了！</p><h3 id=authserver>authserver<a hidden class=anchor aria-hidden=true href=#authserver>#</a></h3><blockquote><p>可以公开的情报：authserver即认证服务，我们登陆账户都是到这里认证后才会请求worldserver，也就是说authserver只有在登陆的时候才起作用，登录后这个进程就可以关闭了！</p></blockquote><h1 id=我们先运行authserver看看>我们先运行authserver看看<a hidden class=anchor aria-hidden=true href=#我们先运行authserver看看>#</a></h1><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>/home/wow/server355/bin/authserver
# or
/home/wow/server355/bin/authserver -c /home/wow/server355/etc/authserver.conf
</code></pre></div><p>以下输出即为成功，很不错！</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>DatabasePool &#39;auth&#39; opened successfully. 2 total connections running.
Started auth database connection pool.
Loading IP Location Database...
Added realm &#34;Trinity&#34; at 192.168.111.111:8085.
</code></pre></div><h3 id=worldserver>worldserver<a hidden class=anchor aria-hidden=true href=#worldserver>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>/home/wow/server355/bin/worldserver
</code></pre></div><p>以下输出即为。。。什么！竟然又报错了！看来之前少下载了一个文件，名字叫<code>TDB_full_world_335.19071_2019_07_15.sql</code>，这个文件在哪里下载呢？</p><p><a href=https://github.com/TrinityCore/TrinityCore/releases>下载传送门，请对号入座</a></p><p>下载下来的文件后缀为7z，我们需要先解压，得到sql文件后直接放在<code>/home/wow/server355/bin/worldserver</code>的同级目录即可！</p><p>再一次，我们运行<code>worldserver</code>，如果得到以下输出，那么恭喜你，你已经沐浴到胜利的阳光了！</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>World initialized in <span style=color:#ae81ff>0</span> minutes <span style=color:#ae81ff>8</span> seconds
TrinityCore rev. 7e10438b2759 2019-07-25 17:00:03 +0200 <span style=color:#f92672>(</span>3.3.5 branch<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>Unix, RelWithDebInfo, Static<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>worldserver-daemon<span style=color:#f92672>)</span> ready...
TC&gt;TC&gt;
</code></pre></div><h3 id=添加账号>添加账号<a hidden class=anchor aria-hidden=true href=#添加账号>#</a></h3><p>上一节我们终于进入了<code>worldserver</code>，下面我们给我们的主角创建一个NO1的账号，使用以下命令格式</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>account create &lt;user&gt; &lt;pass&gt;
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>World initialized in 0 minutes 8 seconds
TrinityCore rev. 7e10438b2759 2019-07-25 17:00:03 +0200 (3.3.5 branch) (Unix, RelWithDebInfo, Static) (worldserver-daemon) ready...
# 这里我们创建了一个用户名为test，密码也为test的账户
TC&gt;TC&gt; account create test test
# 紧接着我们把test账户升级为gm，豪嘛！这老NB了！
TC&gt;TC&gt; account set gmlevel test 3 -1
</code></pre></div><h2 id=登录>登录<a hidden class=anchor aria-hidden=true href=#登录>#</a></h2><p>让我们回到Windows的怀抱，跑到wow客户端下，把下面的代码保存为wow.bat并执行，别管360的提醒，直接允许。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>echo y | rd /s <span style=color:#e6db74>&#34;Cache&#34;</span>
echo SET realmlist <span style=color:#e6db74>&#34;192.168.111.111&#34;</span> &gt; Data<span style=color:#ae81ff>\z</span>hTW<span style=color:#ae81ff>\r</span>ealmlist.wtf
echo SET realmlist <span style=color:#e6db74>&#34;192.168.111.111&#34;</span> &gt; Data<span style=color:#ae81ff>\e</span>nTW<span style=color:#ae81ff>\r</span>ealmlist.wtf
echo SET realmlist <span style=color:#e6db74>&#34;192.168.111.111&#34;</span> &gt; Data<span style=color:#ae81ff>\z</span>hCN<span style=color:#ae81ff>\r</span>ealmlist.wtf
echo SET realmlist <span style=color:#e6db74>&#34;192.168.111.111&#34;</span> &gt; Data<span style=color:#ae81ff>\e</span>nCN<span style=color:#ae81ff>\r</span>ealmlist.wtf
echo SET realmlist <span style=color:#e6db74>&#34;192.168.111.111&#34;</span> &gt; Data<span style=color:#ae81ff>\e</span>nUS<span style=color:#ae81ff>\r</span>ealmlist.wtf
echo SET realmlist <span style=color:#e6db74>&#34;192.168.111.111&#34;</span> &gt; realmlist.wtf
start Wow.exe
goto end
</code></pre></div><p><img loading=lazy src=https://blog.phpgao.com/usr/uploads/2019/07/2129653272.png alt=wow_login></p><p>幽灵虎。。。</p><p><img loading=lazy src=https://blog.phpgao.com/usr/uploads/2019/07/3124592762.png alt=ghost_tiger></p><h2 id=参考>参考<a hidden class=anchor aria-hidden=true href=#参考>#</a></h2><ul><li><a href=https://trinitycore.atlassian.net/wiki/spaces/tc/pages/10977288/Linux+Requirements>https://trinitycore.atlassian.net/wiki/spaces/tc/pages/10977288/Linux+Requirements</a></li><li><a href=https://trinitycore.atlassian.net/wiki/spaces/tc/pages/2130065/GM+Commands>https://trinitycore.atlassian.net/wiki/spaces/tc/pages/2130065/GM+Commands</a></li><li><a href=https://xspio.com/%E9%AD%94%E5%85%BD%E4%B8%96%E7%95%8C%E5%AE%98%E6%96%B9%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%8B%E8%BD%BD>https://xspio.com/%E9%AD%94%E5%85%BD%E4%B8%96%E7%95%8C%E5%AE%98%E6%96%B9%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%8B%E8%BD%BD</a></li></ul></div><footer class=post-footer><nav class=paginav><a class=prev href=https://phpgao.github.io/wow_gm.html><span class=title>« Prev Page</span><br><span>魔兽世界原版GM命令合集</span></a>
<a class=next href=https://phpgao.github.io/setup_charles.html><span class=title>Next Page »</span><br><span>Charles的代理设置</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://phpgao.github.io/>老高的技术博客</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>